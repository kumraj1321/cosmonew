{{#section 'css'}}
    <link rel="stylesheet" href="{{basePath}}/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="{{basePath}}/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="{{basePath}}/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
    <link rel="stylesheet" href="{{basePath}}/plugins/select2/css/select2.min.css">
    <link rel="stylesheet" href="{{basePath}}/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css">
    <link rel="stylesheet" href="{{basePath}}/plugins/select2/css/select2.css">
    <link rel="stylesheet" href="{{basePath}}/dist/css/main.css">
{{/section}}
{{header/mainHeader}}
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Partials Listing according to user</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="/dashboard">Home</a></li>
                        <li class="breadcrumb-item active"><a href="/collection-builder/new">Add New</a></li>
                    </ol>
                </div>
            </div>
        </div><!-- /.container-fluid -->
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Listed Collections</h3>
                        </div>
                        <form method="post" action="/data-filing">
                            <!-- /.card-header -->

                            {{#each collectionData}}
                                {{>(dynamicPartial this.field_type) data=this site_id=../site_id}}

                            {{/each}}

                            <input name="collection_name" value={{collection_name}} type="text"
                                style="display: none;"></input>
                            <button type="submit" class="btn btn-info btn-block" id="btn-submit">Submit Data</button>
                        </form>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
    </section>
    <!-- /.content -->
</div>
{{#section 'script'}}
    <!-- DataTables  & Plugins -->
    <script src="{{basePath}}/plugins/jquery-validation/jquery.validate.min.js"></script>
    <script src="{{basePath}}/plugins/jquery-validation/additional-methods.min.js"></script>
    <script src="{{basePath}}/plugins/select2/js/select2.full.min.js"></script>
    <script src="{{basePath}}/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="{{basePath}}/plugins/jszip/jszip.min.js"></script>
    <script src="{{basePath}}/plugins/pdfmake/pdfmake.min.js"></script>
    <script src="{{basePath}}/plugins/pdfmake/vfs_fonts.js"></script>
    <script src="{{basePath}}/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="{{basePath}}/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
    <script>


        $( "select" ).each( function ()
        {
            var input = $( this ); // This is the jquery object of the input, do what you will
            $( this ).select2()
        } );
        let dynamicId = []
        $( ".dynamicSelect" ).each( function ()
        {
            let startid = $( this ).attr( "id" )
            dynamicId.push( startid )
        } )
        $.each( dynamicId, function ( index, id )
        {
            let splitid = id.split( ',' )
            collection_selected = splitid[ 0 ]
            field_selected = splitid[ 1 ]
            $.ajax( {
                type: 'GET',
                context: this,
                url: `/data-filing/multiselect/${ collection_selected }/${ field_selected }`,
                success: function ( data )
                {
                    let a = ""
                    $.each( data, function ( index, option )
                    {
                        a += `<option value=${ option.key }>${ option.value }</option>`
                    } )
                    let thisid = dynamicId[ index ]
                    thisid = thisid.split( ',' )
                    let b = "#" + thisid[ 0 ] + '\\,' + thisid[ 1 ]
                    $( b ).html( a )
                }
            } );
        } )

    </script>
{{/section}}
{{!-- $( document ).ready( function ()
        {
            $( '.staticSelect' ).select2(); 
            $( '.dynamicSelect' ).select2();


        } ); --}}

{{!-- $( '#staticSelect' ).select2();
        $( '#dynamicSelect' ).select2(); --}}